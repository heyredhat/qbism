---

title: POVM's


keywords: fastai
sidebar: home_sidebar



nb_path: "03povm.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03povm.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="povm_gram" class="doc_header"><code>povm_gram</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>povm_gram</code>(<strong><code>E</code></strong>)</p>
</blockquote>
<p>The Gram matrix is the matrix of inner products. Given POVM elements $\{\hat{E}\}$, we form the matrix:</p>
$$ G_{i,j} = tr(\frac{\hat{E}_{i}}{tr \hat{E}_{i}} \frac{\hat{E}_{j}}{tr \hat{E}_{j}})$$
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check that a SIC-POVM indeed has the correct Gram matrix:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">povm_gram</span><span class="p">(</span><span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">sic_gram</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Why not check out the Hoggar POVM too?</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">povm_gram</span><span class="p">(</span><span class="n">hoggar_povm</span><span class="p">()),</span> <span class="n">sic_gram</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="povm_phi" class="doc_header"><code>povm_phi</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>povm_phi</code>(<strong><code>E</code></strong>)</p>
</blockquote>
<p>Given POVM elements $\{\hat{E}\}$, we first form the matrix:</p>
$$ \hat{\Phi}^{-1}_{i,j} = tr(\hat{E}_{i} \frac{\hat{E}_{j}}{tr \hat{E}_{j}}) $$<p>And then take its inverse to construct $\hat{\Phi}$, the magical quantum transition matrix.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="quantumness" class="doc_header"><code>quantumness</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>quantumness</code>(<strong><code>povm</code></strong>, <strong><code>phi</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>A measure of the "quantumness" of a POVM:</p>
$$ \left\lVert \hat{I} - \hat{\Phi} \right\rVert = \sqrt{tr(\hat{I}-\hat{\Phi})(\hat{I}-\hat{\Phi})$$<p>In other words, the Frobenius distance (2-norm of the vector of singular values) between the magical quantum coherent matrix $\hat{\Phi}$ (aka the "Born matrix") and the identity.</p>
<p>The idea is that the difference between "classical" and "quantum" probabilities amounts to whether or not you stick $\hat{\Phi}$ in between your conditional probability matrix and your vector of probabilities. In the case of complex vector spaces, it's been <a href="https://arxiv.org/abs/quant-ph/0310075">proven</a> than SIC-POVM's minimize this distance under any unitarily invariant norm, such as the Frobenius norm. In other words, SIC-POVM's minimize the quantum deformation of the law of total probability.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dm_probs" class="doc_header"><code>dm_probs</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dm_probs</code>(<strong><code>rho</code></strong>, <strong><code>E</code></strong>)</p>
</blockquote>
<p>Given a density matrix $\rho$, expands it in the basis provided by POVM elements $\{\hat{E}\}$, giving a probability vector $\vec{p}$.</p>
$$ p_{i} = tr(\hat{E}_{i}\rho) $$
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="probs_dm" class="doc_header"><code>probs_dm</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>probs_dm</code>(<strong><code>p</code></strong>, <strong><code>E</code></strong>, <strong><code>phi</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Given a probability vector $\vec{p}$ and a POVM $\{\hat{E}\}$, recovers the density matrix $\rho$. If it's not provided, we first construct $\hat{\Phi}$, the magical quantum coherence matrix, and then form the vector of quasiprobabilities $\vec{q} = \hat{\Phi}\vec{p}$. Then:</p>
$$ \rho = \sum_{i} q_{i}\frac{\hat{E_{i}}}{tr E_{i}}$$
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's try it with a SIC-POVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">probs_dm</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">povm</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A rank-1 Weyl-Heisenberg POVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">probs_dm</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">povm</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And a general Weyl-Heisenberg POVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">probs_dm</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">povm</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="conditional_probs" class="doc_header"><code>conditional_probs</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L70" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>conditional_probs</code>(<strong><code>A</code></strong>, <strong><code>B</code></strong>)</p>
</blockquote>
<p>Given two POVM's $\{\hat{A}\}$ and $\{\hat{B}\}$ (or PVM's), constructs the matrix of conditional probabilities $r(j|i)$ for outcome $A_{j}$ given outcome $B_{i}$:</p>
$$\hat{R}_{j,i} = tr(\hat{A}_{j}\frac{\hat{B}_{i}}{tr \hat{B}_{i}})$$
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use the conditional probability matrix to calculate the probabilities of a PVM (Von Neumann) measurement after a SIC-POVM measurement whose outcome we're ignorant of.</p>
<p>After the initial POVM measurement:</p>
$$ \rho^{\prime} = \sum_{i} p_{i}\frac{\hat{E}_{i}}{tr \hat{E}_{i}} $$<p></p>
<p>Where $p_{i}$ are the probabilities $\vec{p}$ with respect to the POVM, and $\frac{\hat{E}_{i}}{tr \hat{E}_{i}}$ are the outcome states. We can then get the probabilities for the later PVM via $tr (\Pi_{j}\rho^{\prime})$. This should be the same as $\hat{R}\vec{p}$.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">post_povm_rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">prob</span><span class="o">*</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_herm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">pvm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">pvm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">post_povm_rho</span><span class="p">,</span> <span class="n">pvm</span><span class="p">),</span> <span class="n">R</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's try it with a rank-1 Weyl-Heisenberg POVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">post_povm_rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">prob</span><span class="o">*</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_herm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">pvm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">pvm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">post_povm_rho</span><span class="p">,</span> <span class="n">pvm</span><span class="p">),</span> <span class="n">R</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And a general Weyl-Heisenberg POVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">post_povm_rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">prob</span><span class="o">*</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_herm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">pvm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">pvm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">post_povm_rho</span><span class="p">,</span> <span class="n">pvm</span><span class="p">),</span> <span class="n">R</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And if the second measurement is a POVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">post_povm_rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">prob</span><span class="o">*</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">povm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span>

<span class="n">povm2</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">povm2</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">post_povm_rho</span><span class="p">,</span> <span class="n">povm2</span><span class="p">),</span> <span class="n">R</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On the other hand, we can get the quantum probabilities in the case that we go directly to the second measurement by sticking the magical quantum coherence matrix $\hat{\Phi}$ in the middle:</p>
<p>{% raw %}
$$ \vec{q} = \hat{R} \hat{\Phi} \vec{p} $$
{% endraw %}</p>
<p>This should be the same as $tr(\hat{F}_{i} \rho)$, where $\{F\}$ is the second POVM or PVM.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the case of a PVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_herm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">pvm</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">pvm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">pvm</span><span class="p">),</span> <span class="n">R</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the case of a POVM:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">povm2</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">povm2</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm2</span><span class="p">),</span> <span class="n">R</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This also give us a way of representing quantum time evolution.</p>
<p>The usual way of obtaining the evolved probabilities is simply by evolving $\rho$ via some unitary $\hat{U}\rho\hat{U}^{\dagger}$ and the finding the probabilities with respect to the original POVM. Alternatively, we could leave $\rho$ alone, and get the same answer by finding the probabilities with respect to the <em>time reverse evolved</em> POVM, in other words, one whose elements have been evolved $\hat{U}^{\dagger}\hat{E}\hat{U}$.</p>
<p>In terms of the POVM formalism, we form the conditional probability matrix $R_{j,i}$ for outcome $j$ of the evolved POVM given outcome $i$ of the original POVM, and take its transpose. Then the evolved probabilities are: $\hat{R}^{T} \hat{\Phi} \vec{p}$. The same effect could be obtained by working with the conditional probabilities for the reversed evolved POVM given the original POVM, or the conditional probabilities for the original POVM given the evolved POVM.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_unitary</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">evolved_rho</span> <span class="o">=</span> <span class="n">U</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
<span class="n">evolved_povm</span> <span class="o">=</span> <span class="p">[</span><span class="n">U</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">povm</span><span class="p">]</span>
<span class="n">reverse_evolved_povm</span> <span class="o">=</span> <span class="p">[</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">U</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">povm</span><span class="p">]</span>
<span class="n">evolved_povm_given_povm</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">evolved_povm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">evolved_rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">),</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">reverse_evolved_povm</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">evolved_rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">),</span> <span class="n">evolved_povm_given_povm</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">evolved_rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">),</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">reverse_evolved_povm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">evolved_rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">),</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">povm</span><span class="p">,</span> <span class="n">evolved_povm</span><span class="p">)</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Indeed, it's worth observing in this connection that:</p>
<p>{% raw %}
$$ \hat{R}^{T} \hat{\Phi} \hat{R} \hat{\Phi} = \hat{I}_{d^2}$$
{% endraw %}</p>
<p>And $\hat{\Phi}$ will be the same for both the original POVM and the evolved POVM since unitary evolution preserves the inner product.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">evolved_povm_given_povm</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">evolved_povm_given_povm</span> <span class="o">@</span> <span class="n">phi</span><span class="p">,</span> <span class="n">qt</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interestingly, in the case of a SIC-POVM, $\hat{R}^{T} \hat{\Phi}$ and $\hat{R} \hat{\Phi}$, which are inverses, will be each other's transpose, implying that they are orthogonal matrices.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_unitary</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">evolved_povm</span> <span class="o">=</span> <span class="p">[</span><span class="n">U</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">povm</span><span class="p">]</span>
<span class="n">evolved_povm_given_povm</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">evolved_povm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">evolved_povm_given_povm</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span>
<span class="n">Ainv</span> <span class="o">=</span> <span class="n">evolved_povm_given_povm</span> <span class="o">@</span> <span class="n">phi</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Ainv</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, note how operators compose:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_unitary</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="n">rho_evolved</span> <span class="o">=</span> <span class="n">U</span><span class="o">*</span><span class="n">U</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>

<span class="n">evolved_povm</span> <span class="o">=</span> <span class="p">[</span><span class="n">U</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">povm</span><span class="p">]</span>
<span class="n">evolved_povm_given_povm</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">evolved_povm</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">rho_evolved</span><span class="p">,</span> <span class="n">povm</span><span class="p">),</span> <span class="n">evolved_povm_given_povm</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">evolved_povm_given_povm</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="quantum_inner_product" class="doc_header"><code>quantum_inner_product</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L79" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>quantum_inner_product</code>(<strong><code>r</code></strong>, <strong><code>s</code></strong>, <strong><code>phi</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>The quantum inner product expressed in terms of probability vectors. If $\hat{\Phi}$ is not provided,
we use the SIC-POVM $\hat{\Phi}$ of the appropriate dimensionality.</p>
$$ tr(\sigma\rho) = d \vec{s} \hat{\Phi} \vec{r}$$<p>Where $\vec{r}$ is the probability vector for $\rho$ and $\vec{s}$ is the probability vector for $\sigma$ with respect to the same POVM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">((</span><span class="n">rho</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">(),</span> <span class="n">quantum_inner_product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tensor_povm" class="doc_header"><code>tensor_povm</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L94" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tensor_povm</code>(<strong>*<code>povms</code></strong>)</p>
</blockquote>
<p>Forms the tensor product of a list of POVM's, which is itself a POVM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="upgrade_povm" class="doc_header"><code>upgrade_povm</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>upgrade_povm</code>(<strong><code>E</code></strong>, <strong><code>i</code></strong>, <strong><code>dims</code></strong>)</p>
</blockquote>
<p>Upgrades a POVM to act on the $i^{th}$ subspace of a tensor product space whose subspaces are given by a list <code>dims</code>. If <code>dims</code> is an
integer, we assume it refers to the number of subspaces all of the same dimensionality as the POVM.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example, we can get the probabilities for a partial state by upgrading a POVM of the right dimensionality on that subsystem.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">entangled</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">entangled</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">povm2</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">entangled</span><span class="o">.</span><span class="n">ptrace</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">povm2</span><span class="p">),</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">entangled</span><span class="p">,</span> <span class="n">upgrade_povm</span><span class="p">(</span><span class="n">povm2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">entangled</span><span class="o">.</span><span class="n">ptrace</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">povm2</span><span class="p">),</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">entangled</span><span class="p">,</span> <span class="n">upgrade_povm</span><span class="p">(</span><span class="n">povm2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="apply_dims" class="doc_header"><code>apply_dims</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>apply_dims</code>(<strong><code>E</code></strong>, <strong><code>dims</code></strong>)</p>
</blockquote>
<p>Helper function which sets the tensor dimensions of each POVM element to <code>dims</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SQRTM" class="doc_header"><code>SQRTM</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SQRTM</code>(<strong><code>M</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="implement_povm" class="doc_header"><code>implement_povm</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L127" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>implement_povm</code>(<strong><code>E</code></strong>)</p>
</blockquote>
<p>Returns a unitary operator $\hat{U}$ implementing a given POVM on $H_{d} \otimes H_{n}$, where $d$ is the dimensionality
of the original system and $n$ is the dimensionality of the auxilliary system and which is the same as the number of POVM elements.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">implement_povm</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">U</span><span class="o">*</span><span class="n">qt</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">qt</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">qt</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
<span class="n">projectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">qt</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">qt</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">qt</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">proj</span><span class="o">*</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">projectors</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="discriminator_povm" class="doc_header"><code>discriminator_povm</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/povm.py#L147" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>discriminator_povm</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Returns a non informationally complete POVM which has the special property
of distinguishing between two arbitrary states $\mid a \rangle$ and $\mid b\rangle$, which are not necessarily orthogonal (which is impossible with a standard PVM).</p>
<p>It has three elements:</p>
$$ \hat{F}_{a} = \frac{1}{1+\mid\langle a \mid b \rangle\mid}(\hat{I} - \mid b \rangle \langle b \mid) $$$$ \hat{F}_{b} = \frac{1}{1+\mid\langle a \mid b \rangle\mid}(\hat{I} - \mid a \rangle \langle a \mid) $$$$ \hat{F}_{?} = \hat{I} - \hat{F}_{a} - \hat{F}_{b} $$<p>The first tests for "not B", the second tests for "not A", and the third outcome represents an inconclusive result.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the "discriminator POVM" is indeed a POVM, and that if the initial state is $\mid a \rangle \langle a \mid$, then the probability of $\hat{F}_{b}$ is $0$; and if the initial state is $\mid b \rangle \langle b \mid$, then the probability of ${F}_{a}$ is $0$.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">dpovm</span> <span class="o">=</span> <span class="n">discriminator_povm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dpovm</span><span class="p">),</span> <span class="n">qt</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

<span class="n">arho</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
<span class="n">brho</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">arho</span><span class="p">,</span> <span class="n">dpovm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">brho</span><span class="p">,</span> <span class="n">dpovm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">dpovm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">dpovm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tr</span><span class="p">(),</span> <span class="n">dpovm</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.08453251 0.         0.91546749]
[0.         0.08453251 0.91546749]
[0.02206577 0.02206577 0.95586847]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

