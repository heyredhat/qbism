---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "test.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: test.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qbism</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="c1">#load_fiducial(d)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">full</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">shift</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">clock</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="n">d</span><span class="p">)</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">abs</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="n">l</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="n">b</span><span class="p">,</span> <span class="n">psi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span><span class="o">.</span><span class="n">real</span>
<span class="n">F2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">a</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="n">l</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">j</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]))</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span><span class="o">.</span><span class="n">real</span>

<span class="n">F</span><span class="p">,</span> <span class="n">F2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[1.        , 0.19953648, 0.10535632, 0.19953648],
        [0.29751304, 0.42934263, 0.12206722, 0.04572079],
        [0.09536176, 0.23003834, 0.15084493, 0.23003834],
        [0.29751304, 0.04572079, 0.12206722, 0.42934263]]),
 array([[1.        , 0.19953648, 0.10535632, 0.19953648],
        [0.29751304, 0.42934263, 0.12206722, 0.04572079],
        [0.09536176, 0.23003834, 0.15084493, 0.23003834],
        [0.29751304, 0.04572079, 0.12206722, 0.42934263]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">j</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">a</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="n">l</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">a</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">l</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span> \
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span>\
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>\
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span><span class="o">.</span><span class="n">real</span>
<span class="n">G2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[((</span><span class="mi">1</span> <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span>
<span class="n">G</span><span class="p">,</span> <span class="n">G2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[ 0.42259696,  0.22615956,  0.12508392,  0.22615956],
        [ 0.22615956, -0.00762547, -0.01137215, -0.00762547],
        [ 0.12508392, -0.01137215,  0.0030167 , -0.01137215],
        [ 0.22615956, -0.00762547, -0.01137215, -0.00762547]]),
 array([[0.4, 0.2, 0.2, 0.2],
        [0.2, 0. , 0. , 0. ],
        [0.2, 0. , 0. , 0. ],
        [0.2, 0. , 0. , 0. ]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1.        , 0.19953648, 0.10535632, 0.19953648],
       [0.29751304, 0.23753171, 0.12206722, 0.23753171],
       [0.09536176, 0.23003834, 0.15084493, 0.23003834],
       [0.29751304, 0.23753171, 0.12206722, 0.23753171]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span>
<span class="n">g2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">g</span><span class="p">,</span> <span class="n">g2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.4152317457060789, 0.4)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered celltag_outputPrepend">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">onp</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="n">j</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">a</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="n">l</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">a</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">l</span><span class="p">)</span> <span class="o">%</span> <span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span><span class="o">.</span><span class="n">real</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

<span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">loss_grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">onp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">onp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="c1">#a = a/np.linalg.norm(a)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loss_grad: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">loss_grad</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">learning_rate</span><span class="o">*</span><span class="n">loss_grad</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="c1">#a = a/np.linalg.norm(a)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;new a: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">current_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;t=</span><span class="si">%s</span><span class="s2">, loss=</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">current_loss</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">current_loss</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
        <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>12j]
new a: [0.6810467 +0.40032265j 0.43012625+0.35206172j]
t=2049, loss=0.000001
2050
loss_grad: [0.00592631-0.0039213j  0.00539699-0.00372431j]
new a: [0.6810461+0.40032303j 0.4301257+0.35206208j]
t=2050, loss=0.000001
2051
loss_grad: [0.00591159-0.00391157j 0.00538358-0.00371506j]
new a: [0.68104553+0.40032342j 0.43012518+0.35206243j]
t=2051, loss=0.000001
2052
loss_grad: [0.00589768-0.00390237j 0.00537092-0.00370633j]
new a: [0.68104494+0.4003238j 0.43012464+0.3520628j]
t=2052, loss=0.000001
2053
loss_grad: [0.00588337-0.00389291j 0.00535789-0.00369734j]
new a: [0.68104434+0.4003242j  0.4301241 +0.35206315j]
t=2053, loss=0.000001
2054
loss_grad: [0.00586947-0.00388372j 0.00534523-0.00368861j]
new a: [0.68104374+0.40032458j 0.43012357+0.3520635j ]
t=2054, loss=0.000001
2055
loss_grad: [0.00585556-0.00387453j 0.00533256-0.00367988j]
new a: [0.68104315+0.40032497j 0.43012303+0.35206386j]
t=2055, loss=0.000001
2056
loss_grad: [0.00584158-0.00386529j 0.0053198 -0.00367107j]
new a: [0.68104255+0.40032536j 0.4301225 +0.35206422j]
t=2056, loss=0.000001
2057
loss_grad: [0.00582735-0.00385587j 0.00530687-0.00366217j]
new a: [0.68104196+0.40032575j 0.43012196+0.35206458j]
t=2057, loss=0.000001
2058
loss_grad: [0.00581337-0.00384664j 0.00529411-0.00365335j]
new a: [0.68104136+0.40032613j 0.43012142+0.35206494j]
t=2058, loss=0.000001
2059
loss_grad: [0.00579853-0.00383683j 0.00528074-0.00364414j]
new a: [0.68104076+0.40032652j 0.4301209 +0.3520653j ]
t=2059, loss=0.000001
2060
loss_grad: [0.00578482-0.00382776j 0.00526814-0.00363546j]
new a: [0.68104017+0.4003269j  0.43012035+0.35206565j]
t=2060, loss=0.000001
2061
loss_grad: [0.0057701 -0.00381802j 0.00525473-0.00362622j]
new a: [0.6810396+0.4003273j 0.4301198+0.352066j ]
t=2061, loss=0.000001
2062
loss_grad: [0.00575579-0.00380856j 0.0052417 -0.00361723j]
new a: [0.681039  +0.40032768j 0.43011928+0.35206637j]
t=2062, loss=0.000001
2063
loss_grad: [0.00574189-0.00379937j 0.00522904-0.0036085j ]
new a: [0.6810384 +0.40032807j 0.43011874+0.35206673j]
t=2063, loss=0.000001
2064
loss_grad: [0.00572765-0.00378995j 0.0052161 -0.0035996j ]
new a: [0.6810378+0.40032846j 0.4301182+0.35206708j]
t=2064, loss=0.000001
2065
loss_grad: [0.00571408-0.00378098j 0.00520371-0.00359104j]
new a: [0.6810372+0.40032884j 0.4301177+0.35206744j]
t=2065, loss=0.000001
2066
loss_grad: [0.00569977-0.00377152j 0.00519068-0.00358205j]
new a: [0.6810366+0.40032923j 0.4301172+0.3520678j ]
t=2066, loss=0.000001
2067
loss_grad: [0.00568661-0.00376283j 0.00517867-0.00357376j]
new a: [0.681036  +0.40032962j 0.43011668+0.35206816j]
t=2067, loss=0.000001
2068
loss_grad: [0.00567286-0.00375372j 0.0051662 -0.00356519j]
new a: [0.6810354 +0.40033j   0.43011618+0.3520685j]
t=2068, loss=0.000001
2069
loss_grad: [0.00565929-0.00374476j 0.00515382-0.00355664j]
new a: [0.68103486+0.4003304j  0.43011567+0.35206887j]
t=2069, loss=0.000001
2070
loss_grad: [0.00564735-0.00373687j 0.00514292-0.00354911j]
new a: [0.6810343 +0.40033078j 0.43011516+0.35206923j]
t=2070, loss=0.000001
2071
loss_grad: [0.00563476-0.00372854j 0.00513147-0.00354123j]
new a: [0.6810338 +0.40033117j 0.43011466+0.3520696j ]
t=2071, loss=0.000001
2072
loss_grad: [0.0056229 -0.0037207j  0.00512067-0.00353378j]
new a: [0.68103325+0.40033153j 0.43011415+0.35206994j]
t=2072, loss=0.000001
2073
loss_grad: [0.00561076-0.0037127j  0.00510971-0.00352621j]
new a: [0.6810327 +0.40033188j 0.43011364+0.3520703j ]
t=2073, loss=0.000001
2074
loss_grad: [0.00559755-0.00370394j 0.00509759-0.00351787j]
new a: [0.6810322 +0.40033224j 0.43011314+0.35207066j]
t=2074, loss=0.000001
2075
loss_grad: [0.00558528-0.00369583j 0.00508641-0.00351016j]
new a: [0.68103164+0.4003326j  0.43011263+0.35207102j]
t=2075, loss=0.000001
2076
loss_grad: [0.00557253-0.0036874j  0.00507477-0.00350212j]
new a: [0.6810311 +0.40033296j 0.43011212+0.35207137j]
t=2076, loss=0.000001
2077
loss_grad: [0.00555993-0.00367907j 0.00506333-0.00349424j]
new a: [0.6810306 +0.40033332j 0.43011162+0.35207173j]
t=2077, loss=0.000001
2078
loss_grad: [0.00554766-0.00367096j 0.00505216-0.00348654j]
new a: [0.68103004+0.40033367j 0.4301111 +0.3520721j ]
t=2078, loss=0.000001
2079
loss_grad: [0.00553485-0.00366247j 0.0050404 -0.00347846j]
new a: [0.6810295+0.40033403j 0.4301106+0.35207245j]
t=2079, loss=0.000001
2080
loss_grad: [0.0055215 -0.00365365j 0.00502833-0.00347011j]
new a: [0.68102896+0.4003344j 0.4301101 +0.3520728j]
t=2080, loss=0.000001
2081
loss_grad: [0.00550977-0.00364592j 0.00501774-0.00346279j]
new a: [0.6810284+0.40033475j 0.4301096+0.35207316j]
t=2081, loss=0.000001
2082
loss_grad: [0.00549696-0.00363743j 0.00500598-0.00345471j]
new a: [0.6810279 +0.4003351j  0.43010908+0.35207352j]
t=2082, loss=0.000001
2083
loss_grad: [0.00548437-0.0036291j  0.00499454-0.00344683j]
new a: [0.68102735+0.40033546j 0.43010858+0.35207388j]
t=2083, loss=0.000001
2084
loss_grad: [0.00547243-0.00362121j 0.00498364-0.0034393j ]
new a: [0.6810268 +0.40033582j 0.43010807+0.35207424j]
t=2084, loss=0.000001
2085
loss_grad: [0.00545976-0.00361283j 0.0049721 -0.00343134j]
new a: [0.6810263 +0.40033618j 0.43010756+0.3520746j ]
t=2085, loss=0.000001
2086
loss_grad: [0.00544667-0.00360418j 0.00496019-0.00342313j]
new a: [0.68102574+0.40033653j 0.43010706+0.35207492j]
t=2086, loss=0.000001
2087
loss_grad: [0.00543318-0.00359526j 0.0049479 -0.00341465j]
new a: [0.6810252 +0.4003369j  0.43010655+0.35207525j]
t=2087, loss=0.000001
2088
loss_grad: [0.00542051-0.00358688j 0.00493636-0.00340669j]
new a: [0.6810247 +0.40033725j 0.43010604+0.35207558j]
t=2088, loss=0.000001
2089
loss_grad: [0.00540743-0.00357823j 0.00492444-0.00339848j]
new a: [0.68102413+0.4003376j 0.43010554+0.3520759j]
t=2089, loss=0.000001
2090
loss_grad: [0.00539434-0.00356958j 0.00491253-0.00339026j]
new a: [0.6810236 +0.40033796j 0.43010506+0.35207623j]
t=2090, loss=0.000001
2091
loss_grad: [0.00538249-0.00356174j 0.00490173-0.00338282j]
new a: [0.68102306+0.40033832j 0.43010458+0.35207656j]
t=2091, loss=0.000001
2092
loss_grad: [0.00536981-0.00355336j 0.00489019-0.00337486j]
new a: [0.6810225+0.40033868j 0.4301041+0.3520769j ]
t=2092, loss=0.000001
2093
loss_grad: [0.005357  -0.00354487j 0.00487843-0.00336677j]
new a: [0.681022  +0.40033904j 0.43010363+0.35207722j]
t=2093, loss=0.000001
2094
loss_grad: [0.00534487-0.00353687j 0.00486748-0.00335919j]
new a: [0.68102145+0.4003394j  0.43010315+0.35207754j]
t=2094, loss=0.000001
2095
loss_grad: [0.0053322 -0.00352849j 0.00485593-0.00335124j]
new a: [0.6810209 +0.40033975j 0.43010268+0.35207787j]
t=2095, loss=0.000001
2096
loss_grad: [0.00531993-0.00352038j 0.00484476-0.00334353j]
new a: [0.6810204+0.4003401j 0.4301022+0.3520782j]
t=2096, loss=0.000001
2097
loss_grad: [0.00530775-0.00351232j 0.00483369-0.00333591j]
new a: [0.68101984+0.40034047j 0.43010172+0.35207853j]
t=2097, loss=0.000001
2098
loss_grad: [0.005295  -0.00350389j 0.00482205-0.00332787j]
new a: [0.6810193 +0.40034083j 0.43010125+0.35207886j]
t=2098, loss=0.000001
2099
loss_grad: [0.00528273-0.00349578j 0.00481088-0.00332017j]
new a: [0.68101877+0.40034118j 0.43010077+0.35207918j]
t=2099, loss=0.000001
2100
loss_grad: [0.00527014-0.00348745j 0.00479944-0.00331229j]
new a: [0.68101823+0.40034154j 0.4301003 +0.3520795j ]
t=2100, loss=0.000001
2101
loss_grad: [0.00525779-0.00347929j 0.00478817-0.00330451j]
new a: [0.6810177 +0.4003419j  0.43009982+0.35207984j]
t=2101, loss=0.000001
2102
loss_grad: [0.00524594-0.00347145j 0.00477737-0.00329706j]
new a: [0.68101716+0.40034226j 0.43009934+0.35208017j]
t=2102, loss=0.000001
2103
loss_grad: [0.00523354-0.00346323j 0.00476599-0.00328924j]
new a: [0.6810166 +0.4003426j 0.43009886+0.3520805j]
t=2103, loss=0.000001
2104
loss_grad: [0.005221  -0.00345496j 0.00475466-0.0032814j ]
new a: [0.6810161 +0.40034297j 0.43009838+0.35208082j]
t=2104, loss=0.000001
2105
loss_grad: [0.00520841-0.00344663j 0.00474322-0.00327352j]
new a: [0.68101555+0.40034333j 0.4300979 +0.35208115j]
t=2105, loss=0.000001
2106
loss_grad: [0.00519647-0.00343874j 0.00473233-0.003266j  ]
new a: [0.681015  +0.4003437j  0.43009743+0.35208148j]
t=2106, loss=0.000001
2107
loss_grad: [0.00518339-0.00343009j 0.00472041-0.00325778j]
new a: [0.6810145 +0.40034404j 0.43009695+0.3520818j ]
t=2107, loss=0.000001
2108
loss_grad: [0.00517154-0.00342225j 0.00470962-0.00325034j]
new a: [0.68101394+0.40034437j 0.43009648+0.35208213j]
t=2108, loss=0.000001
2109
loss_grad: [0.00515886-0.00341387j 0.00469808-0.00324238j]
new a: [0.6810134+0.4003447j  0.430096 +0.35208246j]
t=2109, loss=0.000001
2110
loss_grad: [0.00514537-0.00340495j 0.00468579-0.00323391j]
new a: [0.68101287+0.40034503j 0.43009552+0.3520828j ]
t=2110, loss=0.000001
2111
loss_grad: [0.0051327 -0.00339657j 0.00467425-0.00322595j]
new a: [0.68101233+0.40034536j 0.43009505+0.35208312j]
t=2111, loss=0.000001
2112
loss_grad: [0.00511962-0.00338792j 0.00466234-0.00321773j]
new a: [0.6810118 +0.40034568j 0.43009457+0.35208344j]
t=2112, loss=0.000001
2113
loss_grad: [0.00510654-0.00337927j 0.00465043-0.00320952j]
new a: [0.68101126+0.400346j   0.4300941 +0.35208377j]
t=2113, loss=0.000001
2114
loss_grad: [0.00509387-0.00337089j 0.00463888-0.00320156j]
new a: [0.6810107 +0.40034634j 0.43009362+0.3520841j ]
t=2114, loss=0.000001
2115
loss_grad: [0.00508092-0.00336235j 0.00462718-0.00319347j]
new a: [0.6810102 +0.40034667j 0.43009314+0.35208443j]
t=2115, loss=0.000001
2116
loss_grad: [0.00506811-0.00335386j 0.00461543-0.00318538j]
new a: [0.68100965+0.400347j   0.4300927 +0.35208476j]
t=2116, loss=0.000001
2117
loss_grad: [0.00505659-0.00334625j 0.00460491-0.00317811j]
new a: [0.6810092 +0.40034732j 0.43009225+0.35208508j]
t=2117, loss=0.000001
2118
loss_grad: [0.00504481-0.00333845j 0.00459421-0.00317075j]
new a: [0.6810087+0.40034765j 0.4300918+0.3520854j ]
t=2118, loss=0.000001
2119
loss_grad: [0.00503426-0.00333147j 0.00458463-0.00316415j]
new a: [0.6810082 +0.40034798j 0.43009135+0.35208574j]
t=2119, loss=0.000001
2120
loss_grad: [0.00502396-0.00332467j 0.00457522-0.00315766j]
new a: [0.68100774+0.4003483j  0.4300909 +0.35208607j]
t=2120, loss=0.000001
2121
loss_grad: [0.00501285-0.00331732j 0.00456508-0.00315064j]
new a: [0.68100727+0.40034863j 0.43009046+0.3520864j ]
t=2121, loss=0.000001
2122
loss_grad: [0.00500189-0.00331007j 0.00455512-0.00314379j]
new a: [0.6810068+0.40034896j 0.43009  +0.35208672j]
t=2122, loss=0.000001
2123
loss_grad: [0.00499126-0.00330304j 0.00454544-0.00313712j]
new a: [0.6810063 +0.4003493j  0.43008956+0.35208705j]
t=2123, loss=0.000001
2124
loss_grad: [0.00497982-0.00329547j 0.00453502-0.00312993j]
new a: [0.68100584+0.40034962j 0.43008912+0.35208738j]
t=2124, loss=0.000001
2125
loss_grad: [0.00496919-0.00328845j 0.00452534-0.00312325j]
new a: [0.68100536+0.40034994j 0.43008867+0.35208768j]
t=2125, loss=0.000001
2126
loss_grad: [0.00495774-0.00328088j 0.00451492-0.00311607j]
new a: [0.6810049 +0.40035027j 0.43008822+0.35208797j]
t=2126, loss=0.000001
2127
loss_grad: [0.00494712-0.00327385j 0.00450524-0.00310939j]
new a: [0.6810044 +0.4003506j  0.43008777+0.35208827j]
t=2127, loss=0.000001
2128
loss_grad: [0.0049354 -0.00326612j 0.00449466-0.00310207j]
new a: [0.6810039 +0.40035093j 0.43008733+0.35208857j]
t=2128, loss=0.000001
2129
loss_grad: [0.00492464-0.00325898j 0.00448477-0.00309527j]
new a: [0.68100345+0.40035126j 0.43008688+0.35208887j]
t=2129, loss=0.000001
2130
loss_grad: [0.00491319-0.00325141j 0.00447434-0.00308808j]
new a: [0.681003  +0.40035158j 0.43008643+0.35208917j]
t=2130, loss=0.000001
2131
loss_grad: [0.00490175-0.00324385j 0.00446392-0.0030809j ]
new a: [0.6810025+0.4003519j  0.430086 +0.35208946j]
t=2131, loss=0.000001
2132
loss_grad: [0.0048903-0.00323628j 0.0044535-0.00307371j]
new a: [0.681002  +0.40035224j 0.43008554+0.35208976j]
t=2132, loss=0.000001
2133
loss_grad: [0.00487926-0.00322898j 0.00444345-0.00306677j]
new a: [0.68100154+0.40035257j 0.4300851 +0.35209006j]
t=2133, loss=0.000001
2134
loss_grad: [0.00486823-0.00322168j 0.0044334 -0.00305984j]
new a: [0.68100107+0.4003529j  0.43008465+0.35209036j]
t=2134, loss=0.000001
2135
loss_grad: [0.00485678-0.00321411j 0.00442297-0.00305266j]
new a: [0.6810006+0.40035322j 0.4300842+0.35209066j]
t=2135, loss=0.000001
2136
loss_grad: [0.00484616-0.00320708j 0.00441329-0.00304598j]
new a: [0.6810001 +0.40035355j 0.43008375+0.35209095j]
t=2136, loss=0.000000
2137
loss_grad: [0.0048339 -0.00319897j 0.00440213-0.00303828j]
new a: [0.68099964+0.40035388j 0.4300833 +0.35209125j]
t=2137, loss=0.000000
2138
loss_grad: [0.00482327-0.00319195j 0.00439245-0.0030316j ]
new a: [0.68099916+0.4003542j  0.43008286+0.35209155j]
t=2138, loss=0.000000
2139
loss_grad: [0.00481169-0.00318427j 0.00438182-0.00302429j]
new a: [0.6809987+0.40035453j 0.4300824+0.35209185j]
t=2139, loss=0.000000
2140
loss_grad: [0.00480038-0.00317681j 0.0043716 -0.00301723j]
new a: [0.6809982 +0.40035486j 0.43008196+0.35209215j]
t=2140, loss=0.000000
2141
loss_grad: [0.00478893-0.00316924j 0.00436118-0.00301004j]
new a: [0.6809977 +0.4003552j  0.43008152+0.35209244j]
t=2141, loss=0.000000
2142
loss_grad: [0.00477763-0.00316178j 0.00435097-0.00300298j]
new a: [0.68099725+0.40035552j 0.43008107+0.35209274j]
t=2142, loss=0.000000
2143
loss_grad: [0.00476686-0.00315465j 0.00434108-0.00299618j]
new a: [0.6809968 +0.40035585j 0.43008062+0.35209304j]
t=2143, loss=0.000000
2144
loss_grad: [0.00475515-0.00314692j 0.0043305 -0.00298886j]
new a: [0.6809963 +0.40035617j 0.43008018+0.35209334j]
t=2144, loss=0.000000
2145
loss_grad: [0.00474425-0.00313967j 0.0043204 -0.00298193j]
new a: [0.6809958 +0.4003565j  0.43007976+0.35209364j]
t=2145, loss=0.000000
2146
loss_grad: [0.00473417-0.00313302j 0.0043113 -0.00297564j]
new a: [0.68099535+0.40035683j 0.43007934+0.35209394j]
t=2146, loss=0.000000
2147
loss_grad: [0.00472231-0.00312518j 0.00430051-0.00296819j]
new a: [0.68099487+0.40035713j 0.43007892+0.35209423j]
t=2147, loss=0.000000
2148
loss_grad: [0.0047121 -0.00311843j 0.00429121-0.00296178j]
new a: [0.6809944+0.40035743j 0.4300785+0.35209453j]
t=2148, loss=0.000000
2149
loss_grad: [0.00470106-0.00311113j 0.00428116-0.00295485j]
new a: [0.6809939+0.40035772j 0.4300781+0.35209483j]
t=2149, loss=0.000000
2150
loss_grad: [0.00468934-0.0031034j  0.00427057-0.00294753j]
new a: [0.68099344+0.40035802j 0.43007767+0.35209513j]
t=2150, loss=0.000000
2151
loss_grad: [0.00467858-0.00309626j 0.00426068-0.00294073j]
new a: [0.68099296+0.40035832j 0.43007725+0.35209543j]
t=2151, loss=0.000000
2152
loss_grad: [0.00466673-0.00308842j 0.00424989-0.00293328j]
new a: [0.6809925 +0.40035862j 0.43007684+0.35209572j]
t=2152, loss=0.000000
2153
loss_grad: [0.00465651-0.00308166j 0.00424059-0.00292686j]
new a: [0.680992  +0.40035892j 0.43007642+0.35209602j]
t=2153, loss=0.000000
2154
loss_grad: [0.00464548-0.00307437j 0.00423054-0.00291993j]
new a: [0.68099153+0.4003592j  0.430076  +0.35209632j]
t=2154, loss=0.000000
2155
loss_grad: [0.00463411-0.00306684j 0.00422021-0.00291282j]
new a: [0.68099105+0.4003595j  0.4300756 +0.35209662j]
t=2155, loss=0.000000
2156
loss_grad: [0.004623  -0.0030595j  0.00421007-0.00290581j]
new a: [0.6809906 +0.4003598j  0.43007517+0.35209692j]
t=2156, loss=0.000000
2157
loss_grad: [0.00461196-0.0030522j  0.00420002-0.00289888j]
new a: [0.6809901 +0.4003601j 0.43007475+0.3520972j]
t=2157, loss=0.000000
2158
loss_grad: [0.00460052-0.00304463j 0.0041896 -0.00289169j]
new a: [0.6809896 +0.4003604j 0.43007433+0.3520975j]
t=2158, loss=0.000000
2159
loss_grad: [0.00458976-0.0030375j  0.00417971-0.00288489j]
new a: [0.68098915+0.4003607j 0.43007392+0.3520978j]
t=2159, loss=0.000000
2160
loss_grad: [0.00457886-0.00303031j 0.00416987-0.00287809j]
new a: [0.68098867+0.400361j  0.4300735 +0.3520981j]
t=2160, loss=0.000000
2161
loss_grad: [0.00456769-0.0030229j  0.00415961-0.00287103j]
new a: [0.6809882 +0.4003613j 0.43007308+0.3520984j]
t=2161, loss=0.000000
2162
loss_grad: [0.00455671-0.00301567j 0.00414967-0.00286414j]
new a: [0.6809877 +0.4003616j 0.43007267+0.3520987j]
t=2162, loss=0.000000
2163
loss_grad: [0.00454494-0.00300787j 0.00413898-0.00285678j]
new a: [0.68098724+0.4003619j 0.43007225+0.352099j ]
t=2163, loss=0.000000
2164
loss_grad: [0.00453398-0.00300062j 0.00412903-0.00284993j]
new a: [0.68098676+0.4003622j 0.43007183+0.3520993j]
t=2164, loss=0.000000
2165
loss_grad: [0.00452361-0.00299377j 0.00411953-0.00284335j]
new a: [0.6809863+0.4003625j 0.4300714+0.3520996j]
t=2165, loss=0.000000
2166
loss_grad: [0.00451217-0.00298621j 0.00410911-0.00283616j]
new a: [0.6809858+0.4003628j 0.430071 +0.3520999j]
t=2166, loss=0.000000
2167
loss_grad: [0.00450108-0.00297884j 0.00409894-0.00282919j]
new a: [0.68098533+0.4003631j  0.43007058+0.35210016j]
t=2167, loss=0.000000
2168
loss_grad: [0.0044899 -0.00297149j 0.00408895-0.00282225j]
new a: [0.68098485+0.4003634j  0.43007016+0.35210043j]
t=2168, loss=0.000000
2169
loss_grad: [0.00447833-0.00296382j 0.00407832-0.00281494j]
new a: [0.6809844 +0.40036368j 0.43006974+0.3521007j ]
t=2169, loss=0.000000
2170
loss_grad: [0.00446648-0.00295598j 0.00406752-0.00280749j]
new a: [0.68098396+0.40036398j 0.43006933+0.35210097j]
t=2170, loss=0.000000
2171
loss_grad: [0.00445626-0.00294922j 0.00405822-0.00280107j]
new a: [0.68098354+0.40036428j 0.4300689 +0.35210124j]
t=2171, loss=0.000000
2172
loss_grad: [0.00444604-0.00294246j 0.00404891-0.00279466j]
new a: [0.6809831+0.40036458j 0.4300685+0.3521015j ]
t=2172, loss=0.000000
2173
loss_grad: [0.0044359 -0.00293575j 0.00403971-0.00278832j]
new a: [0.6809827 +0.40036488j 0.43006808+0.35210177j]
t=2173, loss=0.000000
2174
loss_grad: [0.0044261 -0.00292927j 0.00403078-0.00278216j]
new a: [0.6809823 +0.40036517j 0.43006766+0.35210204j]
t=2174, loss=0.000000
2175
loss_grad: [0.00441608-0.00292262j 0.00402153-0.00277579j]
new a: [0.6809819 +0.40036547j 0.43006727+0.3521023j ]
t=2175, loss=0.000000
2176
loss_grad: [0.0044064 -0.00291625j 0.00401281-0.00276976j]
new a: [0.68098146+0.40036577j 0.43006688+0.35210258j]
t=2176, loss=0.000000
2177
loss_grad: [0.0043966 -0.00290976j 0.00400388-0.0027636j ]
new a: [0.68098104+0.40036607j 0.4300665 +0.35210285j]
t=2177, loss=0.000000
2178
loss_grad: [0.0043872 -0.00290354j 0.00399532-0.00275769j]
new a: [0.6809806+0.40036637j 0.4300661+0.3521031j ]
t=2178, loss=0.000000
2179
loss_grad: [0.0043778 -0.00289733j 0.00398676-0.00275179j]
new a: [0.6809802 +0.40036666j 0.43006572+0.35210338j]
t=2179, loss=0.000000
2180
loss_grad: [0.00436772-0.00289068j 0.00397767-0.0027455j ]
new a: [0.6809798 +0.40036696j 0.43006533+0.35210365j]
t=2180, loss=0.000000
2181
loss_grad: [0.00435941-0.00288517j 0.00397002-0.00274024j]
new a: [0.6809794 +0.40036726j 0.43006495+0.35210392j]
t=2181, loss=0.000000
2182
loss_grad: [0.00435001-0.00287895j 0.00396146-0.00273433j]
new a: [0.68097895+0.40036756j 0.43006456+0.3521042j ]
t=2182, loss=0.000000
2183
loss_grad: [0.00433979-0.00287219j 0.00395215-0.00272792j]
new a: [0.68097854+0.40036786j 0.43006417+0.35210446j]
t=2183, loss=0.000000
2184
loss_grad: [0.0043308 -0.00286625j 0.00394397-0.00272227j]
new a: [0.6809781 +0.40036815j 0.43006378+0.35210472j]
t=2184, loss=0.000000
2185
loss_grad: [0.004321  -0.00285976j 0.00393503-0.00271611j]
new a: [0.6809777+0.40036845j 0.4300634+0.352105j  ]
t=2185, loss=0.000000
2186
loss_grad: [0.00431119-0.00285327j 0.0039261 -0.00270995j]
new a: [0.6809773+0.40036875j 0.430063 +0.35210526j]
t=2186, loss=0.000000
2187
loss_grad: [0.00430138-0.00284679j 0.00391717-0.00270379j]
new a: [0.68097687+0.40036905j 0.43006262+0.35210553j]
t=2187, loss=0.000000
2188
loss_grad: [0.00429247-0.00284089j 0.00390908-0.00269822j]
new a: [0.68097645+0.40036935j 0.43006223+0.3521058j ]
t=2188, loss=0.000000
2189
loss_grad: [0.00428327-0.00283479j 0.00390058-0.00269237j]
new a: [0.68097603+0.40036964j 0.43006185+0.35210606j]
t=2189, loss=0.000000
2190
loss_grad: [0.00427326-0.00282818j 0.00389159-0.00268616j]
new a: [0.6809756 +0.4003699j  0.43006146+0.35210633j]
t=2190, loss=0.000000
2191
loss_grad: [0.00426338-0.00282165j 0.00388256-0.00267991j]
new a: [0.6809752 +0.40037018j 0.43006107+0.3521066j ]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-50-7fd409fd299d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     22</span>     <span class="ansi-red-fg">#a = a/np.linalg.norm(a)</span>
<span class="ansi-green-intense-fg ansi-bold">     23</span>     print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;new a: %s&#34;</span> <span class="ansi-blue-fg">%</span> a<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 24</span><span class="ansi-red-fg">     </span>current_loss <span class="ansi-blue-fg">=</span> loss<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     25</span>     print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;t=%s, loss=%f&#34;</span> <span class="ansi-blue-fg">%</span> <span class="ansi-blue-fg">(</span>n<span class="ansi-blue-fg">,</span> current_loss<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span>     <span class="ansi-green-fg">if</span> np<span class="ansi-blue-fg">.</span>isclose<span class="ansi-blue-fg">(</span>current_loss<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> rtol<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.001</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">&lt;ipython-input-50-7fd409fd299d&gt;</span> in <span class="ansi-cyan-fg">loss</span><span class="ansi-blue-fg">(a)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span class="ansi-green-fg">def</span> loss<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     d <span class="ansi-blue-fg">=</span> a<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">----&gt; 8</span><span class="ansi-red-fg">     </span>G <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">[</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>a<span class="ansi-blue-fg">[</span>j <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>k<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>conjugate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>l<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>conjugate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>k<span class="ansi-blue-fg">+</span>l<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> j <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> l <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>real
<span class="ansi-green-intense-fg ansi-bold">      9</span>     <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>abs<span class="ansi-blue-fg">(</span>G<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span>l<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">**</span><span class="ansi-cyan-fg">2</span> <span class="ansi-green-fg">for</span> l <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">/</span><span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">**</span><span class="ansi-cyan-fg">2</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> 

<span class="ansi-green-fg">&lt;ipython-input-50-7fd409fd299d&gt;</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span class="ansi-green-fg">def</span> loss<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     d <span class="ansi-blue-fg">=</span> a<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">----&gt; 8</span><span class="ansi-red-fg">     </span>G <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">[</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>a<span class="ansi-blue-fg">[</span>j <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>k<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>conjugate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>l<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>conjugate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>k<span class="ansi-blue-fg">+</span>l<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> j <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> l <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>real
<span class="ansi-green-intense-fg ansi-bold">      9</span>     <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>abs<span class="ansi-blue-fg">(</span>G<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span>l<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">**</span><span class="ansi-cyan-fg">2</span> <span class="ansi-green-fg">for</span> l <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">/</span><span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">**</span><span class="ansi-cyan-fg">2</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> 

<span class="ansi-green-fg">&lt;ipython-input-50-7fd409fd299d&gt;</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span class="ansi-green-fg">def</span> loss<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     d <span class="ansi-blue-fg">=</span> a<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">----&gt; 8</span><span class="ansi-red-fg">     </span>G <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">[</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>a<span class="ansi-blue-fg">[</span>j <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>k<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>conjugate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>l<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>conjugate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>j<span class="ansi-blue-fg">+</span>k<span class="ansi-blue-fg">+</span>l<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">%</span> d<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> j <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> l <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>real
<span class="ansi-green-intense-fg ansi-bold">      9</span>     <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>abs<span class="ansi-blue-fg">(</span>G<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span>l<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">**</span><span class="ansi-cyan-fg">2</span> <span class="ansi-green-fg">for</span> l <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">/</span><span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">**</span><span class="ansi-cyan-fg">2</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> 

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py</span> in <span class="ansi-cyan-fg">deferring_binary_op</span><span class="ansi-blue-fg">(self, other)</span>
<span class="ansi-green-intense-fg ansi-bold">   5112</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>other<span class="ansi-blue-fg">,</span> _scalar_types <span class="ansi-blue-fg">+</span> _arraylike_types <span class="ansi-blue-fg">+</span> <span class="ansi-blue-fg">(</span>core<span class="ansi-blue-fg">.</span>Tracer<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   5113</span>       <span class="ansi-green-fg">return</span> NotImplemented
<span class="ansi-green-fg">-&gt; 5114</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> binary_op<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> other<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   5115</span>   <span class="ansi-green-fg">return</span> deferring_binary_op
<span class="ansi-green-intense-fg ansi-bold">   5116</span> 

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py</span> in <span class="ansi-cyan-fg">fn</span><span class="ansi-blue-fg">(x1, x2)</span>
<span class="ansi-green-intense-fg ansi-bold">    386</span> <span class="ansi-green-fg">def</span> _maybe_bool_binop<span class="ansi-blue-fg">(</span>numpy_fn<span class="ansi-blue-fg">,</span> lax_fn<span class="ansi-blue-fg">,</span> bool_lax_fn<span class="ansi-blue-fg">,</span> lax_doc<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    387</span>   <span class="ansi-green-fg">def</span> fn<span class="ansi-blue-fg">(</span>x1<span class="ansi-blue-fg">,</span> x2<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 388</span><span class="ansi-red-fg">     </span>x1<span class="ansi-blue-fg">,</span> x2 <span class="ansi-blue-fg">=</span> _promote_args<span class="ansi-blue-fg">(</span>numpy_fn<span class="ansi-blue-fg">.</span>__name__<span class="ansi-blue-fg">,</span> x1<span class="ansi-blue-fg">,</span> x2<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    389</span>     <span class="ansi-green-fg">return</span> lax_fn<span class="ansi-blue-fg">(</span>x1<span class="ansi-blue-fg">,</span> x2<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> x1<span class="ansi-blue-fg">.</span>dtype <span class="ansi-blue-fg">!=</span> bool_ <span class="ansi-green-fg">else</span> bool_lax_fn<span class="ansi-blue-fg">(</span>x1<span class="ansi-blue-fg">,</span> x2<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    390</span>   <span class="ansi-green-fg">return</span> _wraps<span class="ansi-blue-fg">(</span>numpy_fn<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>fn<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py</span> in <span class="ansi-cyan-fg">_promote_args</span><span class="ansi-blue-fg">(fun_name, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">    321</span>   _check_arraylike<span class="ansi-blue-fg">(</span>fun_name<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    322</span>   _check_no_float0s<span class="ansi-blue-fg">(</span>fun_name<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 323</span><span class="ansi-red-fg">   </span><span class="ansi-green-fg">return</span> _promote_shapes<span class="ansi-blue-fg">(</span>fun_name<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>_promote_dtypes<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    324</span> 
<span class="ansi-green-intense-fg ansi-bold">    325</span> <span class="ansi-green-fg">def</span> _promote_args_inexact<span class="ansi-blue-fg">(</span>fun_name<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py</span> in <span class="ansi-cyan-fg">_promote_dtypes</span><span class="ansi-blue-fg">(*args)</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span>     <span class="ansi-green-fg">return</span> args
<span class="ansi-green-intense-fg ansi-bold">    272</span>   <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 273</span><span class="ansi-red-fg">     </span>to_dtype <span class="ansi-blue-fg">=</span> result_type<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    274</span>     <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>lax<span class="ansi-blue-fg">.</span>convert_element_type<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> to_dtype<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    275</span> 

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py</span> in <span class="ansi-cyan-fg">result_type</span><span class="ansi-blue-fg">(*args)</span>
<span class="ansi-green-intense-fg ansi-bold">    360</span> <span class="ansi-blue-fg">@</span>_wraps<span class="ansi-blue-fg">(</span>np<span class="ansi-blue-fg">.</span>result_type<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    361</span> <span class="ansi-green-fg">def</span> result_type<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 362</span><span class="ansi-red-fg">   </span><span class="ansi-green-fg">return</span> dtypes<span class="ansi-blue-fg">.</span>result_type<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    363</span> 
<span class="ansi-green-intense-fg ansi-bold">    364</span> <span class="ansi-green-fg">def</span> _one_to_one_unop<span class="ansi-blue-fg">(</span>numpy_fn<span class="ansi-blue-fg">,</span> lax_fn<span class="ansi-blue-fg">,</span> promote_to_inexact<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> lax_doc<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/dtypes.py</span> in <span class="ansi-cyan-fg">result_type</span><span class="ansi-blue-fg">(*args)</span>
<span class="ansi-green-intense-fg ansi-bold">    305</span>     <span class="ansi-green-fg">return</span> canonicalize_dtype<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    306</span>   <span class="ansi-red-fg"># TODO(jakevdp): propagate weak_type to the result when necessary.</span>
<span class="ansi-green-fg">--&gt; 307</span><span class="ansi-red-fg">   </span><span class="ansi-green-fg">return</span> canonicalize_dtype<span class="ansi-blue-fg">(</span>_least_upper_bound<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">{</span>_jax_type<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> arg <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/dtypes.py</span> in <span class="ansi-cyan-fg">&lt;setcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    305</span>     <span class="ansi-green-fg">return</span> canonicalize_dtype<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    306</span>   <span class="ansi-red-fg"># TODO(jakevdp): propagate weak_type to the result when necessary.</span>
<span class="ansi-green-fg">--&gt; 307</span><span class="ansi-red-fg">   </span><span class="ansi-green-fg">return</span> canonicalize_dtype<span class="ansi-blue-fg">(</span>_least_upper_bound<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">{</span>_jax_type<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> arg <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/dtypes.py</span> in <span class="ansi-cyan-fg">_jax_type</span><span class="ansi-blue-fg">(value)</span>
<span class="ansi-green-intense-fg ansi-bold">    203</span>   <span class="ansi-green-fg">if</span> any<span class="ansi-blue-fg">(</span>value <span class="ansi-green-fg">is</span> typ <span class="ansi-green-fg">for</span> typ <span class="ansi-green-fg">in</span> _weak_types<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    204</span>     <span class="ansi-green-fg">return</span> value
<span class="ansi-green-fg">--&gt; 205</span><span class="ansi-red-fg">   </span>dtype_ <span class="ansi-blue-fg">=</span> dtype<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span>   <span class="ansi-green-fg">if</span> is_weakly_typed<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    207</span>     pytype <span class="ansi-blue-fg">=</span> type<span class="ansi-blue-fg">(</span>dtype_<span class="ansi-blue-fg">.</span>type<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>item<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/spheres/lib/python3.8/site-packages/jax/dtypes.py</span> in <span class="ansi-cyan-fg">dtype</span><span class="ansi-blue-fg">(x)</span>
<span class="ansi-green-intense-fg ansi-bold">    297</span>   <span class="ansi-green-fg">if</span> type<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">in</span> python_scalar_dtypes<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    298</span>     <span class="ansi-green-fg">return</span> python_scalar_dtypes<span class="ansi-blue-fg">[</span>type<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 299</span><span class="ansi-red-fg">   </span><span class="ansi-green-fg">return</span> np<span class="ansi-blue-fg">.</span>result_type<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    300</span> 
<span class="ansi-green-intense-fg ansi-bold">    301</span> <span class="ansi-green-fg">def</span> result_type<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>
<span class="kn">from</span> <span class="nn">qbism</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">fid</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">(</span><span class="n">onp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6809752</span> <span class="o">+</span><span class="mf">0.40037018</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.43006107</span><span class="o">+</span><span class="mf">0.3521066</span><span class="n">j</span> <span class="p">]))</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
<span class="n">povm_gram</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1.        , 0.11406517, 0.86493904, 0.02099579],
       [0.11406517, 1.        , 0.02099579, 0.86493904],
       [0.86493904, 0.02099579, 1.        , 0.11406517],
       [0.02099579, 0.86493904, 0.11406517, 1.        ]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6809752</span> <span class="o">+</span><span class="mf">0.40037018</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.43006107</span><span class="o">+</span><span class="mf">0.3521066</span><span class="n">j</span> <span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([0.6809752 +0.40037018j, 0.43006107+0.3521066j ], dtype=complex64)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qbism</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm1</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="c1">#weyl_heisenberg_povm(qt.rand_ket(d))</span>
<span class="n">povm2</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="c1">#weyl_heisenberg_povm(qt.rand_ket(d))</span>
<span class="n">phi1</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm1</span><span class="p">)</span>
<span class="n">phi2</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm1</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">povm2</span><span class="p">,</span> <span class="n">povm1</span><span class="p">)</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">povm1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">povm1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">vec</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span> <span class="o">@</span> <span class="n">phi1</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">R</span> <span class="o">@</span> <span class="n">phi1</span> <span class="o">@</span> <span class="n">vec</span><span class="p">)</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">probs_dm</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">povm1</span><span class="p">)</span>
<span class="n">rho</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.33333333 0.08332833 0.08332833 0.08332833 0.08332833 0.08334835
 0.08332833 0.08334835 0.08332833]

[0.33333333 0.08332833 0.08332833 0.08332833 0.08332833 0.08334835
 0.08332833 0.08334835 0.08332833]
[0.33333333 0.08332833 0.08332833 0.08332833 0.08332833 0.08334835
 0.08332833 0.08334835 0.08332833]
[ 1.38777878e-17 -3.46944695e-17 -2.77555756e-17  1.00000000e+00
  3.46944695e-17 -2.42861287e-17  1.38777878e-17 -5.55111512e-17
 -2.77555756e-17]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_latex output_subarea output_execute_result">
Quantum object: dims = [[3], [3]], shape = (3, 3), type = oper, isherm = True\begin{equation*}\left(\begin{array}{*{11}c}-0.687 & (0.442-0.784j) & (0.587-0.009j)\\(0.442+0.784j) & 1.587 & (0.851+1.456j)\\(0.587+0.009j) & (0.851-1.456j) & 0.100\\\end{array}\right)\end{equation*}
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

