---

title: The Weyl-Heisenberg Group


keywords: fastai
sidebar: home_sidebar



nb_path: "00weyl_heisenberg.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00weyl_heisenberg.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clock" class="doc_header"><code>clock</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clock</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<p>The clock operator $\hat{Z}$ for dimension $d$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$Z = 
\begin{pmatrix}
1      &amp; 0      &amp; 0        &amp; \cdots &amp; 0\\
0      &amp; \omega &amp; 0        &amp; \cdots &amp; 0\\
0      &amp; 0      &amp; \omega^2 &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots   &amp; \ddots &amp; \vdots\\
0      &amp; 0      &amp; 0        &amp; \cdots &amp; \omega^{d-1}
\end{pmatrix}
$$<p>Where $\omega = e^{\frac{2\pi i}{d}}$.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="shift" class="doc_header"><code>shift</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>shift</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<p>The shift operator $\hat{X}$ for dimension $d$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$X = 
\begin{pmatrix}
0      &amp; 0      &amp; 0      &amp; \cdots &amp; 0     &amp; 1\\
1      &amp; 0      &amp; 0      &amp; \cdots &amp; 0     &amp; 0\\
0      &amp; 1      &amp; 0      &amp; \cdots &amp; 0     &amp; 0\\
0      &amp; 0      &amp; 1      &amp; \cdots &amp; 0     &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp;\vdots &amp;\vdots\\
0      &amp; 0      &amp; 0      &amp; \cdots &amp; 1     &amp; 0\\ 
\end{pmatrix}
$$
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="displace" class="doc_header"><code>displace</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>displace</code>(<strong><code>d</code></strong>, <strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>The displacement operator $\hat{D}_{a,b} = (-e^{\frac{i\pi}{d}})^{ab}\hat{X}^{b}\hat{Z}^{a}$ for dimension $d$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="weyl_heisenberg_indices" class="doc_header"><code>weyl_heisenberg_indices</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>weyl_heisenberg_indices</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<p>Returns a list with entries $(a, b)$ for $a, b \in [0, d)$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="displacement_operators" class="doc_header"><code>displacement_operators</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>displacement_operators</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<p>Returns a dictionary associating $(a, b)$ with $\hat{D}_{a,b}$ for $a, b \in [0, d)$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="weyl_heisenberg_states" class="doc_header"><code>weyl_heisenberg_states</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>weyl_heisenberg_states</code>(<strong><code>fiducial</code></strong>)</p>
</blockquote>
<p>Applies the $d^2$ displacement operators to a fiducial state, which can be either
a ket or a density matrix.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="weyl_heisenberg_povm" class="doc_header"><code>weyl_heisenberg_povm</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L62" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>weyl_heisenberg_povm</code>(<strong><code>fiducial</code></strong>)</p>
</blockquote>
<p>Generates a Weyl-Heisenberg POVM by applying the $d^2$ displacement operators to a
fiducial state and then, if the fiducial state is a ket $\mid \psi \rangle$, forming the projector $\mid \psi \rangle \langle \psi \mid$, and normalizing by $\frac{1}{d}$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's check that we really get a POVM. Recall that a POVM (a positive operator valued measure) consists in a set of positive semidefinite operators that sum to the identity, i.e., a set $\{E_{i}\}$ such that $\sum_{i} E_{i} = I$.</p>
<p>We can form a POVM whose elements are all rank-1:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">povm_from_state</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">povm_from_state</span><span class="p">),</span> <span class="n">qt</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or not!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">povm_from_dm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">povm_from_dm</span><span class="p">),</span> <span class="n">qt</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The $d^2$ POVM elements form a linearly independent basis for quantum states in a $d$ dimensional Hilbert space. This works because the Weyl-Heisenberg (unitary) displacement operators themselves form an operator basis!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_weyl_heisenberg_basis" class="doc_header"><code>to_weyl_heisenberg_basis</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L70" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_weyl_heisenberg_basis</code>(<strong><code>O</code></strong>, <strong><code>D</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Expands a $d \times d$ operator $O$ in the Weyl-Heisenberg basis with components:</p>
$$ O_{a,b} = \frac{1}{d} tr ( \hat{D}_{a,b}^{\dagger} \hat{O} ) $$<p>Returns a dictionary associating $(a, b)$ with components.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="from_weyl_heisenberg_basis" class="doc_header"><code>from_weyl_heisenberg_basis</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/weyl_heisenberg.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>from_weyl_heisenberg_basis</code>(<strong><code>C</code></strong>, <strong><code>D</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Given a dictionary of Weyl-Heisenberg components, returns the operator $O$
in the standard basis:</p>
$$\hat{O} = \sum_{a,b} O_{a,b}\hat{D}_{a,b}$$
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">O</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_unitary</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">from_weyl_heisenberg_basis</span><span class="p">(</span><span class="n">to_weyl_heisenberg_basis</span><span class="p">(</span><span class="n">O</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

