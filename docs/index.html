---

title: QBism 


keywords: fastai
sidebar: home_sidebar



nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://badge.fury.io/py/qbism"><img src="https://badge.fury.io/py/qbism.svg" alt="PyPI version"></a></p>
<blockquote><p>python tools for the budding quantum bettabilitarian</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation"> </a></h2><p><code>pip install qbism</code></p>
<p>Note that <code>qbism</code> relies on <code>qutip</code>!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2><p>Let's start off with a random density matrix:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qbism</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We construct a random Weyl-Heisenberg IC-POVM, and get the magical quantum coherence matrix. We find the probabilities with respect to this POVM.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">povm</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;probs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>probs: [0.20215649 0.20215649 0.29784351 0.29784351]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can compare the classical probabilities (for a Von Neumann measurement after a POVM measurement whose outcome we are ignorant of) to the the quantum probabilities (in the case where we go directly to the Von Neumann measurement):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_herm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">vn</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">()[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">classical_probs</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">vn</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span> <span class="o">@</span> <span class="n">p</span>
<span class="n">quantum_probs</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">vn</span><span class="p">,</span> <span class="n">povm</span><span class="p">)</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;classsical probs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">classical_probs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;quantum probs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">quantum_probs</span><span class="p">)</span>

<span class="n">post_povm_rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">e</span><span class="o">*</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">e</span><span class="o">.</span><span class="n">tr</span><span class="p">())</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">povm</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">classical_probs</span><span class="p">,</span> <span class="p">[(</span><span class="n">v</span><span class="o">*</span><span class="n">post_povm_rho</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vn</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">quantum_probs</span><span class="p">,</span> <span class="p">[(</span><span class="n">v</span><span class="o">*</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vn</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>classsical probs: [0.55802905 0.44197095]
quantum probs: [0.65778315 0.34221685]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's get a SIC-POVM and explore time evolution:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sic</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">sic_phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">sic</span><span class="p">)</span>
<span class="n">sic_p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">sic</span><span class="p">)</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_unitary</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">evolved_sic</span> <span class="o">=</span> <span class="p">[</span><span class="n">U</span><span class="o">*</span><span class="n">e</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">sic</span><span class="p">]</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">conditional_probs</span><span class="p">(</span><span class="n">evolved_sic</span><span class="p">,</span> <span class="n">sic</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="n">time_evolved_sic_p</span> <span class="o">=</span> <span class="n">R</span> <span class="o">@</span> <span class="n">sic_phi</span> <span class="o">@</span> <span class="n">sic_p</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;time evolved probs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">time_evolved_sic_p</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">dag</span><span class="p">(),</span> <span class="n">sic</span><span class="p">),</span> <span class="n">time_evolved_sic_p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time evolved probs: [0.20445193 0.20445193 0.29554807 0.29554807]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We could also use:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">time_evolved_sic_p2</span> <span class="o">=</span> <span class="n">povm_map</span><span class="p">([</span><span class="n">U</span><span class="p">],</span> <span class="n">sic</span><span class="p">)</span> <span class="o">@</span> <span class="n">sic_phi</span> <span class="o">@</span> <span class="n">sic_p</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">time_evolved_sic_p</span><span class="p">,</span> <span class="n">time_evolved_sic_p2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, let's check out partial traces:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">entangled</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">entangled</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>

<span class="n">povm2</span> <span class="o">=</span> <span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">povm4</span> <span class="o">=</span> <span class="n">apply_dims</span><span class="p">(</span><span class="n">weyl_heisenberg_povm</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">rand_ket</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">povm_phi</span><span class="p">(</span><span class="n">povm4</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">dm_probs</span><span class="p">(</span><span class="n">entangled</span><span class="p">,</span> <span class="n">povm4</span><span class="p">)</span>

<span class="n">ptrA</span> <span class="o">=</span> <span class="n">povm_map</span><span class="p">(</span><span class="n">partial_trace_kraus</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">povm4</span><span class="p">,</span> <span class="n">povm2</span><span class="p">)</span>
<span class="n">ptrB</span> <span class="o">=</span> <span class="n">povm_map</span><span class="p">(</span><span class="n">partial_trace_kraus</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">povm4</span><span class="p">,</span> <span class="n">povm2</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">entangled</span><span class="o">.</span><span class="n">ptrace</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">povm2</span><span class="p">),</span> <span class="n">ptrA</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">entangled</span><span class="o">.</span><span class="n">ptrace</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">povm2</span><span class="p">),</span> <span class="n">ptrB</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check out the tutorial for the full story!</p>
<p>Thanks to <a href="https://nbdev.fast.ai/">nbdev</a>!</p>

</div>
</div>
</div>
</div>
 

