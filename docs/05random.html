---

title: Random POVM's


keywords: fastai
sidebar: home_sidebar



nb_path: "05random.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05random.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we follow the work of Heinosaari, Jivulescu, and Nechita as explained in this <a href="https://arxiv.org/abs/1902.04751v1">paper</a> and in this <a href="https://ion.nechita.net/2019/02/14/random-quantum-measurements/">blog post</a>.</p>
<p>We want to generate a Haar randomly distributed POVM parameterized by $d$, the dimensionality of the Hilbert space, $k$, the number of outcomes, and $n$, the "environment parameter," which controls the mixedness of the POVM effects.</p>
<p>We begin by generating $k$ $d \times n$ "Ginibre matrices," which have "independent, identically distributed complex Gaussian entries" with variance $\frac{1}{2}$.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="random_ginibre" class="doc_header"><code>random_ginibre</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/random.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>random_ginibre</code>(<strong><code>n</code></strong>, <strong><code>m</code></strong>, <strong><code>real</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From these matrices $G$, we can form "Wishart" matrices: $W = GG^{\dagger}$. These will be random positive semidefinite matrices "of typical rank $min(d,n)$".</p>
<p>So we have $k$ Wishart matrices: $W_{i}$. In order to get a POVM, we need to "divide" each $W_{i}$ by their sum:</p>
<p>{% raw %}
$$A_{i} = S^{-\frac{1}{2}}W_{i}S^{-\frac{1}{2}}$$
{% endraw %}</p>
<p>Where $S = \sum_{j} W_{j}$.</p>
<p>Notice that to divide by the matrix sum, we multiply from the left and the right by the half-inverse of $S$.</p>
<p>Finally, we also use the same algorithm to generate real-valued POVM's.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="random_haar_povm" class="doc_header"><code>random_haar_povm</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/random.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>random_haar_povm</code>(<strong><code>d</code></strong>, <strong><code>k</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>1</code></em>, <strong><code>real</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Generates a Haar distributed random POVM for a Hilbert space of dimension $d$, with $k$ elements, and with "mixedness" $n$.</p>
<p>$n$ must satisfy $d \leq kn$, and defaults to $n=1$, giving rank-1 POVM elements.</p>
<p>$k$ defaults to $d^2$ if complex, $\frac{d(d+1)}{2}$ if real.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's test it out:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">rand_dm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">povm</span> <span class="o">=</span> <span class="n">random_haar_povm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">povm</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">probs_dm</span><span class="p">(</span><span class="n">dm_probs</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">povm</span><span class="p">),</span> <span class="n">povm</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also generate randomly distributed POVM elements themselves:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="random_haar_effect" class="doc_header"><code>random_haar_effect</code><a href="https://github.com/heyredhat/qbism/tree/master/qbism/random.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>random_haar_effect</code>(<strong><code>d</code></strong>, <strong><code>k</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>1</code></em>, <strong><code>real</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Generates a Haar distributed random POVM effect of Hilbert space dimension $d$, as if it were part of a POVM of $k$ elements, with mixedness $n$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

